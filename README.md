## Приложение для Благотворительного фонда поддержки котиков QRKot

### Используемые технологии:
- Python 3.9
- FastAPI
- SQLAlchemy 1.4
- Git

## Описание проекта
Фонд собирает пожертвования на различные целевые проекты: на медицинское обслуживание нуждающихся хвостатых, на обустройство кошачьей колонии в подвале, на корм оставшимся без попечения кошкам — на любые цели, связанные с поддержкой кошачьей популяции.

**Проекты**

В Фонде QRKot может быть открыто несколько целевых проектов. У каждого проекта есть название, описание и сумма, которую планируется собрать. После того, как нужная сумма собрана — проект закрывается.
Пожертвования в проекты поступают по принципу First In, First Out: все пожертвования идут в проект, открытый раньше других; когда этот проект набирает необходимую сумму и закрывается — пожертвования начинают поступать в следующий проект.

**Пожертвования**

Каждый пользователь может сделать пожертвование и сопроводить его комментарием. Пожертвования не целевые: они вносятся в фонд, а не в конкретный проект. Каждое полученное пожертвование автоматически добавляется в первый открытый проект, который ещё не набрал нужную сумму. Если пожертвование больше нужной суммы или же в Фонде нет открытых проектов — оставшиеся деньги ждут открытия следующего проекта. При создании нового проекта все неинвестированные пожертвования автоматически вкладываются в новый проект.

**Пользователи**

Целевые проекты создаются администраторами сайта.
Любой пользователь может видеть список всех проектов, включая требуемые и уже внесенные суммы. Это касается всех проектов — и открытых, и закрытых.
Зарегистрированные пользователи могут отправлять пожертвования и просматривать список своих пожертвований.


### Права пользователей (Пожертвования)

Любой **зарегистрированный пользователь** может сделать пожертвование.
**Зарегистрированный пользователь** может просматривать только свои пожертвования, при этом ему выводится только четыре поля:
- id;
- comment;
- full_amount;
- create_date.

> *Информация о том, инвестировано пожертвование в какой-то проект или нет, обычному пользователю **недоступна**.

**Суперпользователь** может просматривать список всех пожертвований, при этом ему выводятся все поля модели.

> *Редактировать или удалять пожертвования **не может никто**.


### Процесс инвестирования

Сразу после создания нового проекта или пожертвования запускается процесс **«инвестирования»** (``execute_investment_process`` в директории ``app/services/investment.py``) (увеличение ``invested_amount`` как в пожертвованиях, так и в проектах, установка значений ``fully_invested`` и ``close_date``, при необходимости).

Если создан новый проект, а в базе были **«свободные»** (не распределённые по проектам) суммы пожертвований — они автоматически инвестируются в новый проект, и в ответе API эти суммы учитываются. То же касается и создания пожертвований: если в момент пожертвования есть открытые проекты, эти пожертвования автоматически зачисляются на их счета.

Функция, отвечающая за инвестирование, вызывается непосредственно из API-функций, отвечающих за создание пожертвований и проектов. Сама функция инвестирования расположена в директории ``app/services/`` в файле ``investment.py``.

## _Как запустить проект:_

Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/IrinaSMR/cat_charity_fund.git
```

```
cd cat_charity_fund
```

Cоздать и активировать виртуальное окружение:

```
python -m venv venv

source venv/scripts/activate
```

Обновить pip и установить зависимости из файла requirements.txt:

```
python -m pip install --upgrade pip

pip install -r requirements.txt
```

Создать файл .env:

```
APP_TITLE=Благотворительный фонд поддержки котиков
DESCRIPTION=Фонд помощи котейкам
DATABASE_URL=your_database
SECRET=your_secret
FIRST_SUPERUSER_EMAIL=your_email
FIRST_SUPERUSER_PASSWORD=your_password
```

Автогенерация миграций:

```
alembic revision --autogenerate -m "Name of Migration"
```

Применение миграций:

```
alembic upgrade head
```

Запуск проекта:

```
uvicorn app.main:app --reload
```

Документация API:

```
http://127.0.0.1:8000/docs

http://127.0.0.1:8000/redoc
```

### Автор:
IrinaSMR
